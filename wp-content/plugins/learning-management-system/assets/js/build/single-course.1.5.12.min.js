function masteriyo_select_single_course_page_tab(e,t){jQuery(".masteriyo-tab").removeClass("active-tab"),jQuery(".tab-content").addClass("masteriyo-hidden"),jQuery(e.target).addClass("active-tab"),jQuery(t).removeClass("masteriyo-hidden")}!function(e,t){var n=function(i,n){var r=t.rootApiUrl+"masteriyo/v1/courses/reviews/"+i;n.force_delete?r+="?force_delete=true":r+="?force_delete=false",e.ajax({type:"delete",headers:{"X-WP-Nonce":t.nonce},url:r,success:n.onSuccess,error:n.onError,complete:n.onComplete})},r=function(i,n){var r=t.rootApiUrl+"masteriyo/v1/courses/reviews";e.ajax({type:"post",headers:{"X-WP-Nonce":t.nonce},url:r,data:i,success:n.onSuccess,error:n.onError,complete:n.onComplete})},o=function(i,n,r){var o=t.rootApiUrl+"masteriyo/v1/courses/reviews/"+i;e.ajax({type:"put",headers:{"X-WP-Nonce":t.nonce},url:o,data:n,success:r.onSuccess,error:r.onError,complete:r.onComplete})},a=function(i,n){e.ajax({type:"POST",dataType:"json",data:{action:"masteriyo_course_reviews_infinite_loading",nonce:t.reviews_listing_nonce,page:i.page,course_id:t.course_id},url:t.ajaxURL,success:n.onSuccess,error:n.onError,complete:n.onComplete})},s=function(e){return'<div class="masteriyo-notify-message masteriyo-alert masteriyo-danger-msg"><span>'+e+"</span></div>"},l=function(e){return'<div class="masteriyo-notify-message masteriyo-alert masteriyo-success-msg"><span>'+e+"</span></div>"},c=function(e){e.find(".masteriyo-notify-message").remove()},m=function(e){for(e=""===e?0:e,e=parseFloat(e),html="",max_rating=t.max_course_rating,e=(e=e>max_rating?max_rating:e)<0?0:e,stars=t.rating_indicator_markup,rating_floor=Math.floor(e),i=1;i<=rating_floor;i++)html+=stars.full_star;for(rating_floor<e&&(html+=stars.half_star),rating_ceil=Math.ceil(e),i=rating_ceil;i<max_rating;i++)html+=stars.empty_star;return html},d=function(i={}){e(document.body).append(e(".masteriyo-confirm-delete-course-review-modal-content").html()),e(".masteriyo-modal-confirm-delete-course-review .masteriyo-cancel").on("click",(function(){e(this).closest(".masteriyo-overlay").remove()})),e(".masteriyo-modal-confirm-delete-course-review .masteriyo-delete").on("click",(function(){var n=e(this).closest(".masteriyo-overlay");n.find(".masteriyo-cancel").attr("disabled",!0),e(this).text(t.labels.deleting),"function"==typeof i.onConfirm&&i.onConfirm((function(){n.remove()}))}))},u={$create_review_form:e(".masteriyo-submit-review-form"),create_review_form_class:".masteriyo-submit-review-form",init:function(){e(document).ready((function(){u.init_sticky_sidebar(),u.init_rating_widget(),u.init_course_reviews_menu(),u.init_curriculum_accordions_handler(),u.init_create_reviews_handler(),u.init_edit_reviews_handler(),u.init_delete_reviews_handler(),u.init_reply_btn_handler(),u.init_course_reviews_loader()}))},init_course_reviews_menu:function(){e(document.body).on("click",".menu-toggler",(function(){if(0==e(this).siblings(".menu").height())return e(this).siblings(".menu").height("auto"),void e(this).siblings(".menu").css("max-height","999px");e(this).siblings(".menu").height(0)})),e(".masteriyo-dropdown .menu li").on("click",(function(){e(this).closest(".menu").height(0)})),e(document.body).click((function(t){e(".masteriyo-dropdown").has(t.target).length>0||e(".masteriyo-dropdown .menu").height(0)}))},init_rating_widget:function(){var t=!1,i=null;u.$create_review_form.on("mouseover",(function(n){var r=e(n.target).closest(".masteriyo-rating-input-icon");if(0===r.length){if(t)return;var o=u.$create_review_form.find('input[name="rating"]').val();return u.$create_review_form.find(".masteriyo-rstar").html(m(o)),t=!0,void(i=null)}o=r.index()+1;var a=r.closest(".masteriyo-rstar");t=!1,i!==o&&(i=o,a.html(m(o)),function(t){t.find(".masteriyo-rating-input-icon").on("click",(function(){var t=e(this).index()+1;u.$create_review_form.find('input[name="rating"]').val(t),e(this).closest(".masteriyo-rstar").html(m(t))}))}(a))}))},init_create_reviews_handler:function(){var e=!1;u.$create_review_form.on("submit",(function(i){i.preventDefault();var n=u.$create_review_form,o=n.find('button[type="submit"]'),a={title:n.find('input[name="title"]').val(),rating:n.find('input[name="rating"]').val(),content:n.find('[name="content"]').val(),parent:n.find('[name="parent"]').val(),course_id:n.find('[name="course_id"]').val()};e||"yes"===n.data("edit-mode")||(e=!0,o.text(t.labels.submitting),c(n),r(a,{onSuccess:function(){n.append(l(t.labels.submit_success)),n.trigger("reset"),window.location.reload()},onError:function(e,i,r){var a=r;e.responseJSON&&e.responseJSON.message&&(a=e.responseJSON.message),n.append(s(a)),o.text(t.labels.submit)},onComplete:function(){e=!1}}))}))},init_reply_btn_handler:function(){e(document.body).on("click",".masteriyo-reply-course-review",(function(i){i.preventDefault();var n=u.$create_review_form,r=e(this).closest(".masteriyo-course-review"),o=r.data("id"),a=n.find('button[type="submit"]'),s=r.find(".title").data("value");n.find('input[name="title"]').val(""),n.find('input[name="rating"]').val(0),n.find(".masteriyo-rstar").html(m(0)),n.find('[name="content"]').val(""),n.find('[name="parent"]').val(o),a.text(t.labels.submit),e(".masteriyo-form-title").text(t.labels.reply_to+": "+s),n.find(".masteriyo-title, .masteriyo-rating").hide(),n.find('[name="content"]').focus(),e("html, body").animate({scrollTop:n.offset().top},500)}))},init_edit_reviews_handler:function(){e(document.body).on("click",".masteriyo-edit-course-review",(function(i){i.preventDefault();var n=u.$create_review_form,r=e(this).closest(".masteriyo-course-review"),o=r.data("id"),a=n.find('button[type="submit"]'),s=r.find(".title").data("value"),l=r.find(".rating").data("value"),c=r.find(".content").data("value"),d=r.find('[name="parent"]').val();n.data("edit-mode","yes"),n.data("review-id",o),n.find('input[name="title"]').val(s),n.find('input[name="rating"]').val(l),n.find(".masteriyo-rstar").html(m(l)),n.find('[name="content"]').val(c),n.find('[name="parent"]').val(d),a.text(t.labels.update),r.is(".is-course-review-reply")?(e(".masteriyo-form-title").text(t.labels.edit_reply),n.find(".masteriyo-title, .masteriyo-rating").hide(),n.find('[name="content"]').focus(),e("html, body").animate({scrollTop:n.offset().top},500)):(e(".masteriyo-form-title").text(t.labels.edit_review+": "+s),n.find(".masteriyo-title, .masteriyo-rating").show(),n.find('input[name="title"]').focus(),e("html, body").animate({scrollTop:n.offset().top},500))}));var i=!1;u.$create_review_form.on("submit",(function(e){e.preventDefault();var n=u.$create_review_form,r=n.data("review-id"),a=n.find('button[type="submit"]'),m={title:n.find('input[name="title"]').val(),rating:n.find('input[name="rating"]').val(),content:n.find('[name="content"]').val(),parent:n.find('[name="parent"]').val(),course_id:n.find('[name="course_id"]').val()};i||"yes"!==n.data("edit-mode")||(i=!0,a.text(t.labels.submitting),c(n),o(r,m,{onSuccess:function(){n.append(l(t.labels.update_success)),a.text(t.labels.update),n.trigger("reset"),window.location.reload()},onError:function(e,i,r){var o=r;e.responseJSON&&e.responseJSON.message&&(o=e.responseJSON.message),n.append(s(o)),a.text(t.labels.update)},onComplete:function(){i=!1}}))}))},init_delete_reviews_handler:function(){var i={};e(document.body).on("click",".masteriyo-delete-course-review",(function(r){r.preventDefault();var o=e(this).closest(".masteriyo-course-review"),a=e(this),l=o.data("id"),c=e("[name=parent][value="+l+"]");i[l]||d({onConfirm:function(r){i[l]=!0,n(l,{force_delete:0===c.length,onSuccess:function(){if(o.hasClass("is-course-review-reply")){var i=0===o.siblings().length,n=o.closest(".masteriyo-course-review-replies").prev();return i&&n.hasClass("masteriyo-delete-review-notice")&&n.fadeOut(500,(function(){e(this).remove()})),void o.fadeOut(500,(function(){i&&o.closest(".masteriyo-course-review-replies").remove(),e(this).remove()}))}o.next().hasClass("masteriyo-course-review-replies")&&o.after(t.review_deleted_notice),o.remove()},onError:function(e,i,n){var r=n;e.responseJSON&&e.responseJSON.message&&(r=e.responseJSON.message),o.append(s(r)),a.find(".text").text(t.labels.delete)},onComplete:function(){i[l]=!1,r()}})}})}))},init_sticky_sidebar:function(){var t=e(".masteriyo-single-course--main").get(0);t&&e(window).scroll((function(){var i=e(window).scrollTop(),n=t.offsetTop,r=n+t.offsetHeight,o=!1;i>n&&i<r&&(o=!0),o?e(".masteriyo-single-course--aside").css({position:"sticky",top:"7.5rem"}):e(".masteriyo-single-course--aside").css({position:"relative",top:"0"})}))},init_curriculum_accordions_handler:function(){e(document.body).on("click",".masteriyo-cheader",(function(){e(this).parent(".masteriyo-stab--citems").toggleClass("active"),e(".masteriyo-stab--citems").length===e(".masteriyo-stab--citems.active").length&&i(),e(".masteriyo-stab--citems").length===e(".masteriyo-stab--citems").not(".active").length&&n()}));var t=!0;function i(){e(".masteriyo-stab--citems").addClass("active"),e(".masteriyo-expand-collape-all").text("Collapse All"),t=!1}function n(){e(".masteriyo-stab--citems").removeClass("active"),e(".masteriyo-expand-collape-all").text("Expand All"),t=!0}e(document.body).on("click",".masteriyo-expand-collape-all",(function(){t?i():n()}))},init_course_reviews_loader:function(){var i=!1,n=1;e("button.masteriyo-load-more").on("click",(function(){if(!i){var r=e(this);i=!0,r.text(t.labels.loading),a({page:n+1},{onSuccess:function(i){i.success&&((n+=1)>=t.course_review_pages&&r.remove(),e(".masteriyo-course-reviews-list").append(i.data.html),e(".course-reviews .masteriyo-danger-msg").remove())},onError:function(e,i,n){var o=n;e.responseJSON&&e.responseJSON.data&&e.responseJSON.data.message&&(o=e.responseJSON.data.message),o||(o=t.labels.see_more_reviews),r.after(s(o))},onComplete:function(){i=!1,r.text(t.labels.see_more_reviews)}})}}))}};u.init()}(jQuery,window.masteriyo_data);